function e(e,t,n,i,r,o,a){try{var s=e[o](a),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(i,r)}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}import{uuidv4 as i}from"@wepin/common";export var Widget=/*#__PURE__*/function(){var r,o;function a(e,t,r,o,s){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),n(this,"id",void 0),n(this,"url",void 0),n(this,"type",void 0),n(this,"isHide",void 0),n(this,"isWidgetReady",!1),n(this,"EL",void 0),n(this,"_open",void 0),this.url=e,this.id="id-".concat(i()),this.isHide=s,a._webview[this.id]=t,this.type=r,this.EL=o,window.addEventListener("message",this.EL),this._open=!0}return r=[{key:"isOpen",get:function(){return this._open}},{key:"close",value:function(){var t,n=this;return(t=function(){return function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,function(e){switch(e.label){case 0:return window.removeEventListener("message",n.EL),n._open=!1,n.isWidgetReady=!1,[4,n._closeWebview()];case 1:return e.sent(),[2]}})},function(){var n=this,i=arguments;return new Promise(function(r,o){var a=t.apply(n,i);function s(t){e(a,r,o,s,u,"next",t)}function u(t){e(a,r,o,s,u,"throw",t)}s(void 0)})})()}},{key:"response",value:function(e){try{this._post(e)}catch(e){console.error("Can not response message to the webview",e)}}},{key:"request",value:function(e){try{this._post(e)}catch(e){console.error("Can not send message to the webview",e)}}}],o=[{key:"getWebview",value:function(e){return a._webview[e]}},{key:"clearWebview",value:function(e){delete a._webview[e]}},{key:"clearAllWebview",value:function(){this._webview={}}}],r&&t(a.prototype,r),o&&t(a,o),a}();n(Widget,"_webview",{});